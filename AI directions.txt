I want to create a population based on the data in population distribution. Create each person in the distribution at the appropriate age and a random gender.

Then assign each person a random income based on their age in alignment to the data in income by gender and age. According to the randomized income (wage, capital gains and other income - totalling these randomly generated numbers to TotalIncome) assign that person an occupation based on their wage income. Taking into account that lower income (higher probability for lower income) younger people are students and older people with lower income are retired. The higher the age the higher the chances are that the person is retired. The retirement chances start at 65 and increase towards 67 and 70. After which they dramatically increase as people get older.